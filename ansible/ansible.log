2024-07-12 02:55:27,204 p=195752 u=rocky n=ansible | ERROR! no module/action detected in task.

The error appears to be in '/home/rocky/yjlee/apps/ansible/roles/setup-kube-apiserver-audit-log/tasks/main.yml': line 24, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Restart rancher server systemd for kube-apiserver
  ^ here

2024-07-12 03:00:07,877 p=199407 u=rocky n=ansible | ERROR! no module/action detected in task.

The error appears to be in '/home/rocky/yjlee/apps/ansible/roles/setup-kube-apiserver-audit-log/tasks/main.yml': line 24, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Restart rancher server systemd for kube-apiserver
  ^ here

2024-07-12 04:00:08,880 p=205636 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:00:08,899 p=205636 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:00:10,432 p=205636 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:00:10,541 p=205636 u=rocky n=ansible | fatal: [master-test3]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/libexec/platform-python"}, "changed": false, "msg": "There was an issue creating /var/log/kubernetes as requested: [Errno 13] Permission denied: b'/var/log/kubernetes'", "path": "/var/log/kubernetes/"}
2024-07-12 04:00:10,549 p=205636 u=rocky n=ansible | fatal: [master-test4]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/libexec/platform-python"}, "changed": false, "msg": "There was an issue creating /var/log/kubernetes as requested: [Errno 13] Permission denied: b'/var/log/kubernetes'", "path": "/var/log/kubernetes/"}
2024-07-12 04:00:10,552 p=205636 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:00:12,268 p=205636 u=rocky n=ansible | fatal: [master-test2]: FAILED! => {"changed": false, "checksum": "61a512f5ef4a0be52edf111bf4f53772aa9067ad", "msg": "Destination /etc/rancher/rke2 not writable"}
2024-07-12 04:00:12,270 p=205636 u=rocky n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************************************************
2024-07-12 04:00:12,270 p=205636 u=rocky n=ansible | master-test2               : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2024-07-12 04:00:12,271 p=205636 u=rocky n=ansible | master-test3               : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2024-07-12 04:00:12,271 p=205636 u=rocky n=ansible | master-test4               : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2024-07-12 04:01:02,504 p=206412 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:01:02,518 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:01:03,528 p=206412 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:01:03,532 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:01:05,147 p=206412 u=rocky n=ansible | changed: [master-test2]
2024-07-12 04:01:05,150 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:01:06,191 p=206412 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:01:06,199 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:01:07,017 p=206412 u=rocky n=ansible | changed: [master-test2]
2024-07-12 04:01:07,027 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Reload systemd] ******************************************************************************************************************************************************************************
2024-07-12 04:01:08,306 p=206412 u=rocky n=ansible | changed: [master-test2]
2024-07-12 04:01:08,311 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Restart rke2-server] *************************************************************************************************************************************************************************
2024-07-12 04:01:42,002 p=206412 u=rocky n=ansible | changed: [master-test2]
2024-07-12 04:01:42,007 p=206412 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:01:42,028 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:01:43,518 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:01:43,521 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:01:44,791 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:01:44,794 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:01:46,050 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:01:46,053 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:01:46,816 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:01:46,823 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Reload systemd] ******************************************************************************************************************************************************************************
2024-07-12 04:01:48,260 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:01:48,262 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Restart rke2-server] *************************************************************************************************************************************************************************
2024-07-12 04:02:31,286 p=206412 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:02:31,291 p=206412 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:02:31,299 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:02:32,908 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:02:32,910 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:02:34,165 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:02:34,168 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:02:35,460 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:02:35,463 p=206412 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:02:36,138 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:02:36,143 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Reload systemd] ******************************************************************************************************************************************************************************
2024-07-12 04:02:37,518 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:02:37,520 p=206412 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Restart rke2-server] *************************************************************************************************************************************************************************
2024-07-12 04:03:20,020 p=206412 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:03:20,023 p=206412 u=rocky n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************************************************
2024-07-12 04:03:20,023 p=206412 u=rocky n=ansible | master-test2               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2024-07-12 04:03:20,024 p=206412 u=rocky n=ansible | master-test3               : ok=6    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2024-07-12 04:03:20,024 p=206412 u=rocky n=ansible | master-test4               : ok=6    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2024-07-12 04:05:13,424 p=209925 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:05:13,439 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:05:14,834 p=209925 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:05:14,837 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:05:16,087 p=209925 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:05:16,091 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:05:17,212 p=209925 u=rocky n=ansible | ok: [master-test2]
2024-07-12 04:05:17,215 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:05:17,231 p=209925 u=rocky n=ansible | skipping: [master-test2]
2024-07-12 04:05:17,241 p=209925 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:05:17,249 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:05:18,571 p=209925 u=rocky n=ansible | ok: [master-test3]
2024-07-12 04:05:18,573 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:05:20,047 p=209925 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:05:20,050 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:05:21,072 p=209925 u=rocky n=ansible | ok: [master-test3]
2024-07-12 04:05:21,076 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:05:21,940 p=209925 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:05:21,949 p=209925 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Reload systemd] ******************************************************************************************************************************************************************************
2024-07-12 04:05:23,440 p=209925 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:05:23,443 p=209925 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Restart rke2-server] *************************************************************************************************************************************************************************
2024-07-12 04:06:07,027 p=209925 u=rocky n=ansible | changed: [master-test3]
2024-07-12 04:06:07,033 p=209925 u=rocky n=ansible | PLAY [kube-apiserver audit log setup play] *****************************************************************************************************************************************************************************************************
2024-07-12 04:06:07,041 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Ensure /var/log/kubernetes directory exists] ************************************************************************************************************************************************************
2024-07-12 04:06:08,522 p=209925 u=rocky n=ansible | ok: [master-test4]
2024-07-12 04:06:08,524 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy kube-apiserver audit policy configuration file] ****************************************************************************************************************************************************
2024-07-12 04:06:09,749 p=209925 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:06:09,751 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Copy rancher rke2 config.yaml] **************************************************************************************************************************************************************************
2024-07-12 04:06:10,874 p=209925 u=rocky n=ansible | ok: [master-test4]
2024-07-12 04:06:10,877 p=209925 u=rocky n=ansible | TASK [setup-kube-apiserver-audit-log : Restart rancher server systemd for kube-apiserver] ******************************************************************************************************************************************************
2024-07-12 04:06:11,577 p=209925 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:06:11,583 p=209925 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Reload systemd] ******************************************************************************************************************************************************************************
2024-07-12 04:06:12,957 p=209925 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:06:12,959 p=209925 u=rocky n=ansible | RUNNING HANDLER [setup-kube-apiserver-audit-log : Restart rke2-server] *************************************************************************************************************************************************************************
2024-07-12 04:06:56,794 p=209925 u=rocky n=ansible | changed: [master-test4]
2024-07-12 04:06:56,809 p=209925 u=rocky n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************************************************
2024-07-12 04:06:56,810 p=209925 u=rocky n=ansible | master-test2               : ok=3    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2024-07-12 04:06:56,810 p=209925 u=rocky n=ansible | master-test3               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2024-07-12 04:06:56,810 p=209925 u=rocky n=ansible | master-test4               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2024-07-12 04:08:19,426 p=212618 u=rocky n=ansible | rancher-master-test3 | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added 'rancher-master-test3' (ECDSA) to the list of known hosts.\r\nrocky@rancher-master-test3: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).",
    "unreachable": true
}
2024-07-12 04:08:19,427 p=212618 u=rocky n=ansible | rancher-master-test2 | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added 'rancher-master-test2' (ECDSA) to the list of known hosts.\r\nrocky@rancher-master-test2: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).",
    "unreachable": true
}
2024-07-12 04:08:19,430 p=212618 u=rocky n=ansible | rancher-master-test4 | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added 'rancher-master-test4' (ECDSA) to the list of known hosts.\r\nrocky@rancher-master-test4: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).",
    "unreachable": true
}
2024-07-12 04:09:35,881 p=213713 u=rocky n=ansible | rancher-master-test4 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
2024-07-12 04:09:35,973 p=213713 u=rocky n=ansible | rancher-master-test3 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
2024-07-12 04:09:35,981 p=213713 u=rocky n=ansible | rancher-master-test2 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/libexec/platform-python"
    },
    "changed": false,
    "ping": "pong"
}
2024-07-12 04:10:01,855 p=214114 u=rocky n=ansible | rancher-master-test4 | FAILED | rc=126 >>
/bin/sh: /var/log/kubernetes/audit/: Is a directorynon-zero return code

2024-07-12 04:10:01,900 p=214114 u=rocky n=ansible | rancher-master-test2 | FAILED | rc=126 >>
/bin/sh: /var/log/kubernetes/audit/: Is a directorynon-zero return code

2024-07-12 04:10:02,118 p=214114 u=rocky n=ansible | rancher-master-test3 | FAILED | rc=126 >>
/bin/sh: /var/log/kubernetes/audit/: Is a directorynon-zero return code

2024-07-12 04:10:11,444 p=214265 u=rocky n=ansible | rancher-master-test4 | CHANGED | rc=0 >>
audit.log

2024-07-12 04:10:11,453 p=214265 u=rocky n=ansible | rancher-master-test3 | CHANGED | rc=0 >>
audit.log

2024-07-12 04:10:11,513 p=214265 u=rocky n=ansible | rancher-master-test2 | CHANGED | rc=0 >>
audit-2024-07-10T06-23-18.250.log
audit-2024-07-10T23-08-45.392.log
audit-2024-07-11T00-21-10.849.log
audit-2024-07-11T01-31-50.355.log
audit-2024-07-11T02-43-29.026.log
audit-2024-07-11T03-55-06.588.log
audit-2024-07-11T05-06-05.513.log
audit-2024-07-11T06-16-51.891.log
audit-2024-07-11T07-28-36.240.log
audit-2024-07-11T08-41-42.225.log
audit-2024-07-11T09-53-11.158.log
audit-2024-07-11T23-47-15.609.log
audit-2024-07-12T00-36-55.393.log
audit-2024-07-12T01-26-28.889.log
audit-2024-07-12T02-16-09.846.log
audit-2024-07-12T03-05-55.494.log
audit-2024-07-12T03-55-24.079.log
audit.log

2024-07-12 04:10:21,114 p=214417 u=rocky n=ansible | rancher-master-test2 | CHANGED | rc=0 >>
audit-2024-07-10T06-23-18.250.log
audit-2024-07-10T23-08-45.392.log
audit-2024-07-11T00-21-10.849.log
audit-2024-07-11T01-31-50.355.log
audit-2024-07-11T02-43-29.026.log
audit-2024-07-11T03-55-06.588.log
audit-2024-07-11T05-06-05.513.log
audit-2024-07-11T06-16-51.891.log
audit-2024-07-11T07-28-36.240.log
audit-2024-07-11T08-41-42.225.log
audit-2024-07-11T09-53-11.158.log
audit-2024-07-11T23-47-15.609.log
audit-2024-07-12T00-36-55.393.log
audit-2024-07-12T01-26-28.889.log
audit-2024-07-12T02-16-09.846.log
audit-2024-07-12T03-05-55.494.log
audit-2024-07-12T03-55-24.079.log
audit.log

2024-07-12 04:10:21,973 p=214417 u=rocky n=ansible | rancher-master-test3 | CHANGED | rc=0 >>
audit.log

2024-07-12 04:10:22,908 p=214417 u=rocky n=ansible | rancher-master-test4 | CHANGED | rc=0 >>
audit.log

